---
title: CSS样式的优先权问题
id: 197
categories:
  - CSS
date: 2007-08-10 23:44:21
tags:
---

今天编辑CSS样式表遇到一个CSS重复定义的问题，要在不修改页面内容的情况下，指定层选用特定的一个Class，而这个class在样式表中有多处重复定义。后来[去蓝色问了问](http://bbs.blueidea.com/thread-2779093-1-1.html)，才知道是CSS的优先权问题。下面是一些关于CSS优先权的解释和说明。

CSS优先权问题其实就是一个冲突解决的问题，当同一个元素(或内容)被CSS选择符选中时，就要按照优先权取舍不同的CSS规则，这其中涉及到的问题其实很多。

首先就是CSS规则的specificity(特殊性)，CSS2.1有一套关于specificity的计算方式，用一个四位的数字串(CSS2是三位)来表示，最终specificity越高的规则越特殊，在优先级判定时也就越有优势。关于specificity的具体计算在各种情况下的数字加成有如下一般规则：

* 每个ID选择符(#someid)，加 0,1,0,0。
* 每个class选择符(.someclass)、每个属性选择符(形如[attr=”"]等)、每个伪类(形如:hover等)加0,0,1,0
* 每个元素或伪元素(:firstchild)等，加0,0,0,1
* 其他选择符包括全局选择符*，加0,0,0,0。相当于没加，不过这也是一种specificity，后面会解释。

按这些规则将数字串逐位相加，就得到最终计算得的specificity，然后在比较取舍时按照从左到右的顺序逐位比较。

举一些例子吧：

[code lang="css"]

h1 {color: red;}

/* 只有一个普通元素加成，结果是 0,0,0,1 */

body h1 {color: green;}

/* 两个普通元素加成，结果是 0,0,0,2 */

——后者胜出

h2.grape {color: purple;}

/* 一个普通元素、一个class选择符加成，结果是 0,0,1,1*/

h2 {color: silver;}

/*一个普通元素，结果是 0,0,0,1 */

——前者胜出

html > body table tr[id=”totals”] td ul > li {color: maroon;}

/* 7个普通元素、一个属性选择符、两个其他选择符，结果是0,0,1,7 */

li#answer {color: navy;}

/* 一个ID选择符，一个普通选择符，结果是0,1,0,1 */

[/code]

——后者胜出

除了specificity还有一些其他规则

* 文内的样式优先级为1,0,0,0，所以始终高于外部定义。这里文内样式指形如

< div > blah < / div >的样式，而外部定义指经由

< link >或< style >标签定义的规则。

* 有!important声明的规则高于一切。
* 如果!important声明冲突，则比较优先权。
* 如果优先权一样，则按照在源码中出现的顺序决定，后来者居上。
* 由继承而得到的样式没有specificity的计算，它低于一切其他规则(比如全局选择符*定义的规则)。
* 关于经由@import载入的外部样式，由于@import必须出现在所有其他规则定义之前(如不是，则浏览器应该忽略之)，所以按照后来居上原则，一般优先权冲突时是占下风的。

这里需要提一下IE，IE是可以识别位置错误的@import的，但无论@import在什么地方，它都认为是位于所有其他规则定义之前的，这可能会引发一些误会。